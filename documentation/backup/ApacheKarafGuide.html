<h1>Installing jclouds on Apache KarafKaraf,OSGi</h1>

<p>Instructions on how to install Jclouds on <a href="http://karaf.apache.org">Apache Karaf</a> and run the examples.</p>

<h2>Introduction</h2>

<p>Apache Karaf is an OSGi runtime which runs on top of most OSGi containers like <a href="http://felix.apache.org">Apache Felix</a> and
<a href="http://www.eclipse.org/equinox/">Eclipse Equinox</a>. JClouds provide easy integration with Apache Karaf by leveraging the Karaf <em>"Feature"</em> concept.</p>

<p>This section will describe how to install JClouds on Karaf and run some examples that demonstrate the power of
JClouds in a dynamic environment such as Karaf.</p>

<p>JClouds provides the following Karaf "features"</p>

<ul><li>jclouds-aws-ec2</li>
<li>jclouds-googlestorage</li>
<li>jclouds-gogrid</li>
<li>jclouds-eucalyptus-s3</li>
<li>jclouds-eucalyptus-ec2</li>
<li>jclouds-azureblob</li>
<li>jclouds-cloudfiles-uk</li>
<li>jclouds-cloudfiles-us</li>
<li>jclouds-cloudloadbalancers-us</li>
<li>jclouds-cloudonestorage</li>
<li>jclouds-cloudserver-uk</li>
<li>jclouds-cloudserver-us</li>
<li>jclouds-cloudsigma-zrh</li>
<li>jclouds-elastichosts-lon-b</li>
<li>jclouds-elastichosts-lon-p</li>
<li>jclouds-elastichosts-sat-p</li>
<li>jclouds-hosteurope-storage</li>
<li>jclouds-ninefold-storage</li>
<li>jclouds-openhosting-east1</li>
<li>jclouds-savvis-symphonyvpdc</li>
<li>jclouds-scaleup-storage</li>
<li>jclouds-serverlove-z1-man</li>
<li>jclouds-skalicloud-sdg-my</li>
<li>jclouds-slicehost</li>
<li>jclouds-synaptic-storage</li>
<li>jclouds-tiscali-storage</li>
<li>jclouds-trmk-ecloud</li>
<li>jclouds-trmk-vcloudexpress</li>
</ul><h2>Installation</h2>

<ul><li>Get jclouds-karaf from https://github.com/jclouds/jclouds-karaf.</li>
</ul><p>As of jclouds 1.0.0 release jcoulds-karaf feature is available on central maven repository, so you can skip this step of getting the source
and building it and go directly to the install of JClouds feature.</p>

<pre><code>git clone git://github.com/jclouds/jclouds-karaf.git
cd jclouds-karaf
mvn clean install</code></pre>

<ul><li>Start Karaf and install the JClouds feature!</li>
</ul><pre><code>features:addurl mvn:org.jclouds.karaf/feature/1.0/xml/features
features:install jclouds</code></pre>

<p>Now the core of JClouds is installed. You can select which additional JClouds features you wish and install them using the shell:</p>

<pre><code>features:list | grep jclouds</code></pre>

<p><em><em>Example</em></em></p>

<p>For installing the module for aws-s3:</p>

<pre><code>features:install jclouds-aws-s3</code></pre>

<p>= Running the examples =
There is an example available which demonstrates how you can use JClouds inside Karaf.
The examples leverages the Karaf Shell and the configuration admin, in order to provide 2 shell commands that
read and write data to a blobstore. The blobstore provider and the access information are configurable via
the OSGi configuration admin and can change dynamically.</p>

<p>The first step is to get and build the example:</p>

<pre><code>git clone https://iocanel@github.com/jclouds/jclouds-examples.git
cd jcoulds-examples/blobstore-karaf-shell
mvn clean install</code></pre>

<p>Then from Karaf shell you can install the example:</p>

<pre><code>osgi:install -s mvn:org.jclouds.examples/blobstore-karaf-shell/1.0-SNAPSHOT</code></pre>

<p>The command above installs in Karaf two new commands:</p>

<ul><li>jclouds:blobstore-write</li>
<li>jclouds:blobstore-read</li>
</ul><p>In order to use those commands, you first need to configure the provider. The configuration is done
using the org.jclouds.blobstore PID. You can create the configuration either from inside the shell or
by dropping  a file named org.jclouds.blobstore.cfg under karaf's etc folder.
Let's see how it can be done using the Karaf shell:</p>

<pre><code>config:edit org.jclouds.blobstore
config:propset provider aws-s3
config:propset accessKeyId XXXXXX 
config:propset secretKey XXXXXX 
config:update</code></pre>

<p>Now you are ready to use the commands</p>

<pre><code>jclouds:blobstore-write mybucket myblob JCloudsRocks
jclouds:blobstore-write mybucket myblob</code></pre>

<p>At any point in time, you can edit the configuration, either using the shell or
by editing the configuration file. The commands will pick up the changes immediately.
This way you can even switch providers.</p>

<p>You can also watch the <a href="http://www.youtube.com/watch?v=SIvSaGEKrkM">demo video</a>.</p>

<p><code>Last Updated: 2011-07-26</code></p>